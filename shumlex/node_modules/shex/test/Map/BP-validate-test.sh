#!/bin/sh
../../bin/validate -x BPFHIR.shex -d BPFHIR.ttl -n tag:BPfhir123 -e '
return require("../lib/ShExLoader").load(["BPunitsDAM.shex"], [], []).
  then(function (loaded) {
    var db = require("../extensions/shex-map").materializer(loaded.schema).
      materialize(validator.semActHandler.results["http://shex.io/extensions/Map/#"], "tag:b0").
      getTriples(null, null, null);
    var w = require("n3").Writer({ prefixes: { map: "http://shex.io/extensions/Map/#" } });
    w.addTriples(db); w.end(function (error, result) { console.log(result); });
  });'; echo $?
